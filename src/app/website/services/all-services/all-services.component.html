<div class="web auto-flex-start-gap40-column main-div">

    <div class="auto-flex-center-space-between-gap20 light-gray-bg border-none border-radius-0 padding-left-right-30">

        <!-- Current Location-->
        <div class="auto-flex-center-start-gap20-no-set-width cursor-pointer desktop" (click)="showCurrentLocation()">

            <img class="smallImg" src="assets/images/web/icons/location.svg" />

            <div class="auto-flex-start-gap5-column-no-set-width width-max-500">

                <p class="med bold">{{ 'allServices.currentLocation' | translate }}</p>
                <p class="web-font-primary-light width-300">{{ locationName }}</p>

            </div>

        </div>

        <a class="cursor-pointer" (click)="navigate('/')">
            <img class="xxmedImg" src="assets/images/web/logo.svg" />
        </a>

        <div class="auto-flex-center-gap20-no-set-width desktop">

            <a class="xsmall web-font-primary bold cursor-pointer" (click)="navigate('/')">{{ 'header.home' | translate }}</a>
            <a class="xsmall web-font-primary bold" href="https://www.taibsa.com/blog">{{ 'header.blog' | translate }}</a>
            <a class="xsmall web-font-primary bold" href="https://www.taibsa.com/medical-calculator">{{ 'header.calculator' | translate }}</a>
            <a class="xsmall web-font-primary bold" href="https://www.taibsa.com/contact">{{ 'header.contact' | translate }}</a>
            
            <a class="auto-flex-center-gap10-no-set-width xsmall web-font-primary bold gray-border padding-5 border-radius-10 cursor-pointer" (click)="switchLanguage('ar')" *ngIf="languageService.getCurrentLanguage() === 'en'">
            
                <img class="xsmallImg" src="assets/images/web/icons/saFlag.svg" />
                <p>عربي</p>
            
            </a>    

            <a class="auto-flex-center-gap10-no-set-width xsmall web-font-primary bold gray-border padding-5 border-radius-10 cursor-pointer" (click)="switchLanguage('en')" *ngIf="languageService.getCurrentLanguage() === 'ar'">
            
                <img class="xsmallImg" src="assets/images/web/icons/ukFlag.svg" />
                <p>En</p>
            
            </a>    


            <div class="auto-flex-center-gap5-no-set-width cursor-pointer">

                <a class="xsmall web-font-primary bold" (click)="navigate('/checkout/cart')"><img class="img-20" src="assets/images/web/icons/cart.svg" /></a>
                <div class="auto-flex-center-gap10 border-radius-100 red-bg border-none height-16 width-16 text-center padding-15"  *ngIf="cartData && cartData.length>0">

                    <a class="xsmall secondary-color"  (click)="navigate('/checkout/cart')">{{ cartLength }}</a>
    
                </div>
 
            </div>

            
            <a class="xsmall lightest-blue-bg cursor-pointer padding-10 border-none" (click)="navigateToLogin()" *ngIf="userId === null">{{ 'header.patientLogin' | translate }}</a>
            <a class="xsmall lightest-blue-bg cursor-pointer padding-10 border-none" (click)="navigateToLogin()" *ngIf="userId !== null"><img class="img-20" src="assets/images/web/icons/account_login.svg" /></a>
         
        </div>

        <div class="mobile auto-flex-center-gap10-no-set-width padding-10 white-bg">

            <a class="xsmall web-font-primary bold" (click)="openMenu()">
                <img class="xsmallImg" src="assets/images/web/icons/menu.svg" />
            </a>

        </div>

        <div class="light-gray-bg fixed mobile z-index menu-mobile mobile padding-none" id="menuBar" style="z-index: 10000;">

            <a class="xsmall web-font-primary bold" [class.absolute-top-right-30]="languageService.getCurrentLanguage() === 'en'" [class.absolute-top-left-30]="languageService.getCurrentLanguage() === 'ar'" (click)="closeMenu()"><img class="img-20" src="assets/images/web/icons/close.svg" /></a>

            <div class="auto-flex-start-gap20-column padding-20">

                <a class="xsmall web-font-primary bold" href="www.taibsa.com">{{ 'header.home' | translate }}</a>
                <a class="xsmall web-font-primary bold" href="https://www.taibsa.com/blog">{{ 'header.blog' | translate }}</a>
                <a class="xsmall web-font-primary bold" href="https://www.taibsa.com/medical-calculator">{{ 'header.calculator' | translate }}</a>
                <a class="xsmall web-font-primary bold" href="https://www.taibsa.com/contact">{{ 'header.contact' | translate }}</a>
                <a class="auto-flex-center-gap10-no-set-width xsmall web-font-primary bold gray-border padding-5 border-radius-10 cursor-pointer" (click)="switchLanguage('ar')" *ngIf="languageService.getCurrentLanguage() === 'en'">
            
                    <img class="xsmallImg" src="assets/images/web/icons/saFlag.svg" />
                    <p>عربي</p>
                
                </a>    
    
                <a class="auto-flex-center-gap10-no-set-width xsmall web-font-primary bold gray-border padding-5 border-radius-10 cursor-pointer" (click)="switchLanguage('en')" *ngIf="languageService.getCurrentLanguage() === 'ar'">
                
                    <img class="xsmallImg" src="assets/images/web/icons/ukFlag.svg" />
                    <p>En</p>
                
                </a>    
    
                <div class="auto-flex-center-gap5-no-set-width">

                    <a class="xsmall web-font-primary bold" (click)="navigate('/checkout/cart')"><img class="img-20" src="assets/images/web/icons/cart.svg" /></a>
                    <div class="auto-flex-center-gap10 border-radius-100 red-bg border-none height-16 width-16 text-center padding-15"  *ngIf="cartData && cartData.length>0">

                        <a class="xsmall secondary-color">{{ cartData.length }}</a>

                    </div>

                </div>
                        
                <a class="xsmall lightest-blue-bg cursor-pointer padding-10 border-none" (click)="navigateToLogin()" *ngIf="userId === null">{{ 'header.patientLogin' | translate }}</a>
                <a class="xsmall lightest-blue-bg cursor-pointer padding-10 border-none" (click)="navigateToLogin()" *ngIf="userId !== null"><img class="img-20" src="assets/images/web/icons/account_login.svg" /></a>

            </div>

        </div>

    </div>

</div>

<div class="web auto-flex-start-gap40-column main-div-max padding-top-20 padding-20" style="padding: 20px;">

     <!-- Current Location-->
    <div class="auto-flex-center-start-gap20 mobile cursor-pointer padding-10 border-radius-10" (click)="showCurrentLocation()" style="background-image: url('assets/images/web/location.svg'); background-size: cover;">

        <img class="smallImg phone-xSmallImg" src="assets/images/web/icons/location.svg" />

        <div class="auto-flex-start-gap5-column-no-set-width width-max-500 phone-max-width-auto">

            <p class="med bold">{{ 'allServices.currentLocation' | translate }}</p>
            <p class="web-font-primary-light width-max-300">{{ locationName }}</p>

        </div>

    </div>

    <!-- Top Category -->
    <div class="auto-flex-center-space-between-gap20 place-stretch desktop-category" *ngIf="allServices && allServices.length>0">

        <div class="auto-flex-center-space-between-gap20-no-set-width width-half-screen lightest-blue-bg padding-20 padding-bottom-0 cursor-pointer min-height-150" [style.background-color]="category.bg_color" *ngFor="let category of topCategories; let topCategoryIndex = index"  (click)="navigateToCategory(category.id)">

            <div class="auto-flex-start-gap10-column-no-set-width width-max-300 phone-width-120 padding-bottom-20">

                <p class="med bold capitalize width-max-350"> {{ languageService.getCurrentLanguage() === 'ar' ? category.title_arabic : category.title }} </p>
                <p class="web-font-primary-light width-max-350 width-max-phone-130"> {{ languageService.getCurrentLanguage() === 'ar' ? category.description_arabic : category.description }} </p>

            </div>

            <div class="auto-flex-end-gap10-no-set-width white-bg padding-none max-height phone-width-120 border-none relative self-stretch border-bottom-left-bottom-right-0 phone-max-height-150">

                <img class="xxxmedImg" src="{{serverUrl}}{{category.image}}" />

            </div>

        </div>
    
    </div>

    <!-- Top Category -->
    <div class="auto-flex-center-space-between-gap20 place-stretch mobile-category" *ngIf="allServices && allServices.length>0">

        <div class="auto-flex-center-gap20-column-no-set-width width-half lightest-blue-bg padding-20 padding-bottom-0 cursor-pointer min-height-150" [style.background-color]="category.bg_color" *ngFor="let category of topCategories; let topCategoryIndex = index"  (click)="navigateToCategory(category.id)">

            <div class="auto-flex-start-gap10-column">

                <p class="med bold capitalize">{{ languageService.getCurrentLanguage() === 'ar' ? category.title_arabic : category.title }}</p>
                <p class="web-font-primary-light"> {{ languageService.getCurrentLanguage() === 'ar' ? category.description_arabic : category.description }} </p>

            </div>

            <div class="auto-flex-end-gap10-no-set-width white-bg padding-20 border-none relative border-bottom-left-bottom-right-0" style="align-self: flex-end">

                <img class="xmedImg" src="{{serverUrl}}{{category.image}}" />

            </div>

        </div>
    
    </div>

    <!-- All Ctegories -->
    <div class="auto-flex-start-gap20-column light-gray-bg" *ngIf="allServices && allServices.length>0">

        <p class="xmed bold capitalize">{{ 'allServices.categories' | translate }}</p>
        
        <div class="auto-flex-start-gap20-no-wrap overflow-auto padding-bottom-20 place-stretch scroll-bar">

            <div class="auto-flex-center-gap10-column-no-set-width white-bg cursor-pointer border-radius-20 width-min-150 padding-10 item-hover" (click)="navigateToCategory(category.id)" *ngFor="let category of allCategories; let categoryIndex = index">

                <img class="medImg" src="{{serverUrl}}{{category.icon}}" />
                <p class="bold capitalize web-font-primary-light xsmall text-center">{{ languageService.getCurrentLanguage() === 'ar' ? category.title_arabic : category.title }}</p>

            </div>
        </div>

    </div>

    <!-- Services -->
    <div class="auto-flex-center-gap30-column" *ngIf="allServices && allServices.length>0">
        <div class="auto-flex-center-gap30-column" *ngFor="let item of displayedCategories">

            <div class="auto-flex-start-gap20-column" *ngIf="item.services.length>0">

                <p class="xmed bold capitalize">{{ languageService.getCurrentLanguage() === 'ar' ? item.category_data.title_arabic : item.category_data.title }}</p>
        
                <div class="auto-flex-start-center-gap20-no-wrap overflow-auto padding-bottom-20 place-stretch scroll-bar-gray">
        
                    <div class="auto-flex-space-between-gap20-column-no-set-width gray-border border-radius-20 cursor-pointer padding-none width-max-350 relative" (click)="navigateToService(service.id)" *ngFor="let service of item.services">
        
                        <p class="absolute-top-left-10 xsmall primary-bg padding-5 padding-left-right-10  border-none" style="z-index: 2;">{{ service.price }} {{ 'header.sar' | translate }}</p>
                        
                        <div class="linear-gradient-blue absolute height-160 border-top-left-right-10"></div>
                        <img class="xxlargeImg-350 height-160 cover border-top-left-right-10" src="{{serverUrl}}{{service.cover_image}}">
        
                        <div class="auto-flex-start-gap10-column-no-set-width padding-left-right-10">
        
                            <p class="med bold capitalize">{{ languageService.getCurrentLanguage() === 'ar' ? service.title_arabic : service.title }}</p>
                            <p class="web-font-primary-light">   {{ (languageService.getCurrentLanguage() === 'ar' ? (service.description_arabic | translate) : (service.description | translate)) | slice:0:90 }}...</p>
        
                        </div>
        
                        <div class="auto-flex-end-gap10">
        
                            <button *ngIf="languageService.getCurrentLanguage() === 'en'" class="primary-bg padding-10 capitalize box-shadow border-none border-top-left-bottom-left-0 border-top-right-0 padding-left-right-30 padding-top-bottom-5 xsmall">{{ 'allServices.viewMore' | translate }}</button>
                            <button *ngIf="languageService.getCurrentLanguage() === 'ar'" class="primary-bg padding-10 capitalize box-shadow border-none border-bottom-right-top-right-0 border-top-left-0 padding-left-right-30 padding-top-bottom-5 xsmall">{{ 'allServices.viewMore' | translate }}</button>

                        </div>
        
                    </div>
        
                    <div class="auto-flex-center-gap20-column-no-set-width cursor-pointer width-min-100" (click)="showMore(item.category_data.url)">
        
                        <img class="smallImg" src="assets/images/web/icons/plus.svg" />
                        <p class="xsmall bold lowercase text-center">{{ 'allServices.loadMore' | translate }}</p>
        
                    </div>
        
                </div>
            
            </div>
        
        </div>
    </div>

    <div class="auto-flex-center-gap20" *ngIf="allServices && allServices.length>0 && displayedCategories[0].services.length>0">

        <button class="primary-bg padding-10 box-shadow xsmall width-max-300 max-width uppercase" (click)="loadMoreCategories()" *ngIf="allCategories && displayedCategories.length<allCategories.length">{{ 'allServices.loadMore' | translate }}</button>

    </div>

    <!-- Location Modal -->
    <div class="auto-flex-center-gap10 fixed dialog" *ngIf="userCurrentLocation" style="z-index: 1000;">

        <div class="popup" style="width: 100%;">

            <div class="auto-flex-start-gap20-column-no-set-width padding-40 white-bg overflow-auto max-height-500 border-radius-20 width-600 max-width relative" style="width: 100%;">

                <div class="auto-flex-end-gap10">

                    <a class="xsmall web-font-primary bold cursor-pointer" (click)="userCurrentLocation = !userCurrentLocation"><img class="img-20" src="assets/images/web/icons/close.svg" /></a>

                </div>

                <div class="auto-flex-center-gap20-column">
    
                    <div class="auto-flex-start-gap20-column box-shadow padding-none border-radius-10 gray-border">
                        
                        <agm-map class="max-width height-200 border-top-left-right-10 overflow-hidden" [latitude]="centerLat" [longitude]="centerLng" [zoom]="zoom" [streetViewControl]="false" [zoomControl]="false" [mapTypeControl]="false">
                        
                        </agm-map>
    
                        <div class="auto-flex-center-space-between-gap20 padding-left-right-30 padding-bottom-20">
    
                            <div class="auto-flex-start-gap10-column-no-set-width width-300">
    
                                <p class="bold">{{ cityName }}</p>
                                <p class="web-font-primary-light"> {{ locationName }} </p>
        
                            </div>
                            <!--openMap()-->
                            <div class="auto-flex-center-gap10-no-set-width cursor-pointer" (click)="openMap()">

                                <img class="smallImg cursor-pointer" src="assets/images/web/icons/edit.svg" (click)="openMap()" />
                                <p class="xsmall bold">{{ 'allServices.editLocation' | translate }}</p>
 
                            </div>
    
                        </div>
                  
                    </div>
    
                    <div class="auto-flex-center-start-gap20 cursor-pointer" (click)="openMap()" *ngIf="userId!==null">
    
                        <img class="xsmallImg" src="assets/images/web/icons/plus_black.svg" />
                        <p class="xsmall bold lowercase text-center">{{ 'allServices.addNewAddress' | translate }}</p>
    
                    </div>
    
                    <div class="auto-flex-start-gap10-no-wrap overflow-auto width-max-500" *ngIf="userLocations.length>0">
    
                        <div class="auto-flex-start-gap10-column-no-set-width padding-bottom-20 scroll-bar-gray" *ngFor="let loc of userLocations; let locIndex = index;">
    
                            <div class="auto-flex-start-gap10-column-no-set-width white-bg box-shadow item-hover cursor-pointer width-200" (click)="setCurrentLocation(loc)">
        
                                <p class="xsmall bold">{{ 'allServices.addressName' | translate }}: {{ loc.address_name }}</p>
                                <p class="xsmall" *ngIf="loc.city && loc.city.length>0">{{ 'allServices.addressCity' | translate }}: {{ loc.city }}</p>
                                <p class="xsmall" *ngIf="loc.address_line1 && loc.address_line1.length>0">{{ 'allServices.addressLine' | translate }}: {{ loc.address_line1 }} {{ loc.address_line2 }}</p>
        
                            </div>
        
                        </div>
    
                    </div>

                </div>
               
            </div>

        </div>

    </div>

    <!-- Location Modal Select -->
    <div class="auto-flex-center-gap10 fixed dialog" *ngIf="selectMapLocation" (click)="closeMap()">

        <div class="popup">

            <div class="auto-flex-center-gap30-column-no-set-width white-bg overflow-auto max-height-500 border-radius-20 width-600 relative padding-none border-none">

                <div class="auto-flex-center-gap20-column box-shadow padding-none border-radius-10 gray-border" (click)="$event.stopPropagation()">

                    <input #search class="input-global absolute-top-10 z-index width-90Percent" type="text" placeholder="{{ 'patientProfile.searchLocation' | translate }}" />

                    <agm-map class="max-width height-300 width-600 phone-300 border-top-left-right-10 overflow-hidden" [latitude]="centerLat" [longitude]="centerLng" [zoom]="zoom" [streetViewControl]="false" [zoomControl]="false" [mapTypeControl]="false" (mapClick)="onMapClick($event)" >
                
                        <agm-marker *ngIf="selectedLat && selectedLng" [latitude]="selectedLat"  [longitude]="selectedLng" [markerDraggable]="true" (dragEnd)="onMarkerDragEnd($event);"  class="border-radius-10"></agm-marker>
                    
                    </agm-map>

                    <button *ngIf="placeSelected" class="primary-bg padding-10 border-none box-shadow absolute-bottom-10 width-300 phone-width-150 z-index uppercase box-shadow-16-50" (click)="onConfirmLocation()">{{ 'allServices.confirmLocation' | translate }}</button>
                
                </div>

            </div>

        </div>

    </div>

    <!-- Add new address -->
    <div class="auto-flex-center-gap10 fixed dialog" *ngIf="addNewAddressToggle">

        <div class="popup">

            <div class="auto-flex-start-gap20-column white-bg overflow-auto max-height-500 border-radius-20 width-min-600 phone-min-width">
                
                <div class="auto-flex-start-no-gap-column">

                    <div class="auto-flex-center-space-between-gap20">

                        <p class="med bold capitalize">{{ 'allServices.addNewAddress' | translate }}</p>
                        <img class="xsmallImg cursor-pointer" src="assets/images/web/icons/close.svg" (click)="discardAddress()" />
    
                    </div>
    
                    <hr class="hr-black" />    

                </div>

                <form class="auto-flex-start-gap10" [formGroup]="addressForm" (ngSubmit)="createAddress()">

                    <div class="auto-flex-start-gap10-column web-font-primary-light">
        
                        <p class="xsmall bold">{{ 'allServices.addressName' | translate }}</p>
                        <input class="input-global" type="text" formControlName="address_name" placeholder="{{ 'allServices.addressName_1_placeholder' | translate }}" />
                        <p *ngIf="addressForm.get('address_name').hasError('invalidAddressName')" class="xsmall red-color">{{ 'allServices.addressName_1_placeholder' | translate }}</p>

                    </div>    

                    <div class="auto-flex-start-gap10 web-font-primary-light">

                        <p class="xsmall bold">{{ 'allServices.addressLine_1' | translate }}</p>
                        <input class="input-global" type="text" formControlName="address_line1"  placeholder="{{ 'allServices.addressLine_1_placeholder' | translate }}" />
                        <p *ngIf="addressForm.get('address_line1').hasError('invalidAddressLine1')" class="xsmall red-color">{{ 'allServices.addressLine_1' | translate }}</p>

                    </div>    
    
                    <div class="auto-flex-start-gap10 web-font-primary-light">
    
                        <p class="xsmall bold">{{ 'allServices.addressLine_2' | translate }}</p>
                        <input class="input-global" type="text" placeholder="{{ 'allServices.addressLine_2_placeholder' | translate }}" />
            
                    </div>    
    
                    <p *ngIf="addressForm.get('latitude').hasError('invalidLocation') || addressForm.get('longitude').hasError('invalidLocation')" class="xsmall red-color">{{ 'allServices.enterValidLocation' | translate }}</p>
                    
                    <div class="auto-flex-end-gap10">
        
                        <!-- continue button -->
                        <button class="primary-bg padding-10 box-shadow width-200 xsmall phone-width-auto uppercase" type="submit">{{ 'allServices.saveChanges' | translate }}</button>
    
                    </div>
                    
                </form>
            
            </div>

        </div>

    </div>

    <!-- An Error occured while updating user. Try again later -->
    <app-custom-alert *ngIf="showErrorUpdatingAddress" [title]="'Error'" [message]="'An error occured while saving address in your account but you can use this address to book service.'" [cancelButtonText]="'Cancel'" [continueButtonText]="'Continue'" (cancelClick)="handleCancelClick()" (continueClick)="handleContinueClick()" [showCancel]="false" [showConfirm]="true"></app-custom-alert>

    <div class="auto-flex-center-gap10 lightest-blue-bg" *ngIf="allServices && allServices.length<=0">

        <p class="bold">{{ 'allServices.noServiceFound' | translate }}</p>

    </div>

</div>

<app-checkout-footer></app-checkout-footer>